#include<bits/stdc++.h>
using namespace std;

#define sc(n) scanf("%d",&n)
#define scl(n) scanf("%lld",&n)
#define ll long long
#define lop(i,n) for(int i=0;i<n;++i)
typedef pair<int,int> ii;
typedef pair<ll,ll>  pll;

int vis[(1<<16)+10],n,mn[20],mx[20],nr[20], W[20][20];
int S[20];
void solve(int pcnt,int mask2,int mask,int rem,int currank){
	if(!pcnt&&vis[mask])return ;
	if(!pcnt)vis[mask]=1;
	if(rem==1){
		lop(i,n)if(mask&(1<<i)){
			mn[i]=min(mn[i],1);
			mx[i]=max(mx[i],1);
			return ;
		}
	}
	if(pcnt==rem/2){
		solve(0,0,mask,rem/2,S[rem/2]);
	}
	else {
		int a1;
		lop(i,n){
			if((mask&(1<<i))&&(!(mask2&(1<<i)))){
				a1=i;
				break;
			}
		}
		mask2^=1<<(a1);
		for(int i=a1+1;i<n;++i){
			if((mask&(1<<i))&&(!(mask2&(1<<i)))){
				mask2^=(1<<i);
				if(W[a1][i]){
					mn[i]=min(mn[i],currank);
					mx[i]=max(mx[i],currank);
					mask^=(1<<i);
				}
				else {
					mn[a1]=min(mn[a1],currank);
					mx[a1]=max(mx[a1],currank);
					mask^=(1<<a1);
				}
				solve(pcnt+1,mask2,mask,rem,currank);
				mask2^=(1<<i);
				if(W[a1][i])mask^=(1<<i);
				else mask^=(1<<a1);
			}
		}
	}
}

int main(){
#ifndef ONLINE_JUDGE
    //freopen("i.txt","r",stdin);
   // freopen("o.txt","w",stdout);
#endif
    S[1]=1;
    S[2]=2;
    S[4]=3;
    S[8]=5;
    S[16]=9;
    int t;
    sc(t);
    lop(C,t){
    	sc(n);
    	lop(i,n)lop(j,n)sc(W[i][j]);
    	memset(vis,0,sizeof vis);
    	lop(i,20)mn[i]=100,mx[i]=-1;
    	solve(0,0,(1<<n)-1,n,S[n]);
    	printf("Case #%d: \n",C+1);
    	lop(i,n)printf("%d %d\n",mn[i],mx[i]);
    }
}
